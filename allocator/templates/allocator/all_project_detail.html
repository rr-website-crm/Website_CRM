{% extends 'base.html' %}
{% block title %}Project {{ job.system_id }} - CRM Portal{% endblock %}

{% block content %}
<div class="fade-in">
    <div class="dashboard-header" style="display:flex;justify-content:space-between;align-items:center;margin-bottom:var(--spacing-xl);">
        <div>
            <h1 class="dashboard-title">Project Overview</h1>
            <p class="dashboard-subtitle">System ID: {{ job.system_id }} | Job ID: {{ job.job_id }}</p>
        </div>
        <a href="{% url 'allocator_all_projects' %}" class="btn btn-outline">&larr; Back to All Projects</a>
    </div>

    <div class="grid two-columns" style="display:grid;gap:var(--spacing-xl);grid-template-columns:repeat(auto-fit,minmax(320px,1fr));">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">Basic Information</h3>
            </div>
            <div class="card-body">
                <dl class="data-list">
                    <div class="data-list-row">
                        <dt>Topic</dt>a
                        <dd>{{ job.topic|default:'--' }}</dd>
                    </div>
                    <div class="data-list-row">
                        <dt>Word Count</dt>
                        <dd>{{ job.word_count|default:'--' }}</dd>
                    </div>
                    <div class="data-list-row">
                        <dt>Category</dt>
                        <dd>{{ job.get_category_display|default:'--' }}</dd>
                    </div>
                    <div class="data-list-row">
                        <dt>Deadline</dt>
                        <dd>{% if job.deadline %}{{ job.deadline|date:"M d, Y" }}{% else %}--{% endif %}</dd>
                    </div>
                    <div class="data-list-row">
                        <dt>Status</dt>
                        <dd><span class="status-tag">{{ job.portal_status }}</span></dd>
                    </div>
                    <div class="data-list-row">
                        <dt>Marketing Member</dt>
                        <dd>{{ job.created_by.get_full_name|default:job.created_by.email }}</dd>
                    </div>
                </dl>
            </div>
        </div>

        <div class="card">
            <div class="card-header">
                <h3 class="card-title">Instructions</h3>
            </div>
            <div class="card-body">
                <p style="white-space:pre-line;">{{ job.instruction|default:'No instructions available.' }}</p>
            </div>
        </div>
    </div>

    <div class="card" style="margin-top:var(--spacing-xl);">
        <div class="card-header" style="display:flex;justify-content:space-between;align-items:center;">
            <h3 class="card-title">Attachments</h3>
            <span class="dashboard-subtitle">{{ attachments|length }} file(s)</span>
        </div>
        <div class="card-body">
            {% if attachments %}
                <ul class="file-list">
                    {% for attachment in attachments %}
                        <li>
                            <a href="{{ attachment.file.url }}" target="_blank">
                                {{ attachment.original_filename }}
                            </a>
                            <small style="display:block;color:var(--text-muted);">Uploaded on {{ attachment.uploaded_at|date:"M d, Y H:i" }}</small>
                        </li>
                    {% endfor %}
                </ul>
            {% else %}
                <p style="color:var(--text-muted);">No attachments available.</p>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
