{% extends 'base.html' %}
{% load static %}

{% block title %}All Writers - CRM Portal{% endblock %}

{% block content %}
<div class="dashboard-header">
    <h1 class="dashboard-title">All Writers</h1>
    <p class="dashboard-subtitle">View writer profiles and engagement status</p>
</div>

<div class="card">
    <div class="card-header">
        <h2 class="card-title">Writer Directory</h2>
    </div>
    <div class="card-body">
        {% if writer_data %}
        <div class="table-container">
            <table class="data-table">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Employee ID</th>
                        <th>Specialization</th>
                        <th>Engaged Jobs</th>
                        <th>Total Words</th>
                        <th>Max Capacity</th>
                        <th>Availability</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for writer in writer_data %}
                    <tr>
                        <td><strong>{{ writer.user.get_full_name }}</strong></td>
                        <td>{{ writer.user.email }}</td>
                        <td>{{ writer.user.employee_id|default:"N/A" }}</td>
                        <td>
                            {% if writer.assigned_category %}
                                <span class="status-tag" style="text-transform:uppercase;font-size:0.8rem;">
                                    {{ writer.assigned_category }}
                                </span>
                            {% else %}
                                <span style="opacity:0.6;">Not set</span>
                            {% endif %}
                        </td>
                        <td>
                            <strong>{{ writer.engagement.engaged_jobs }}</strong> / {{ writer.profile.max_jobs }}
                        </td>
                        <td>
                            <strong>{{ writer.engagement.total_words }}</strong> / {{ writer.profile.max_words }}
                        </td>
                        <td>
                            <div>Jobs: {{ writer.engagement.available_slots }}</div>
                            <div style="font-size: 0.875rem; opacity: 0.7;">Words: {{ writer.engagement.available_words }}</div>
                        </td>
                        <td>
                            {% if writer.profile.is_sunday_off %}
                                <span class="status-tag" style="background-color: rgba(255, 152, 0, 0.2); color: #FF9800; font-size: 0.75rem;">Sunday Off</span>
                            {% elif writer.profile.is_on_holiday %}
                                <span class="status-tag" style="background-color: rgba(244, 67, 54, 0.2); color: #F44336; font-size: 0.75rem;">On Holiday</span>
                            {% elif writer.profile.is_overloaded %}
                                <span class="status-tag" style="background-color: rgba(255, 193, 7, 0.2); color: #FFC107; font-size: 0.75rem;">Overloaded</span>
                            {% else %}
                                <span style="opacity: 0.7;">-</span>
                            {% endif %}
                        </td>
                        <td>
                            {% if writer.availability_status == 'Available' %}
                                <span class="status-tag status-completed">Available</span>
                            {% else %}
                                <span class="status-tag status-hold">Not Available</span>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <div style="text-align: center; padding: 3rem; color: var(--text-color); opacity: 0.6;">
            <svg width="64" height="64" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-bottom: 1rem; opacity: 0.5;">
                <path d="M17 21V19C17 17.9391 16.5786 16.9217 15.8284 16.1716C15.0783 15.4214 14.0609 15 13 15H5C3.93913 15 2.92172 15.4214 2.17157 16.1716C1.42143 16.9217 1 17.9391 1 19V21" stroke="currentColor" stroke-width="2"/>
                <circle cx="9" cy="7" r="4" stroke="currentColor" stroke-width="2"/>
            </svg>
            <p style="font-size: 1.1rem;">No writers found</p>
        </div>
        {% endif %}
    </div>
</div>

<!-- Writer Categories -->
<div class="card-grid" style="margin-top: 2rem;">
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">IT Writers</h3>
        </div>
        <div class="card-body">
            <div style="font-size: 2rem; font-weight: 700; color: #2196F3; text-align: center;">
                {{ writer_stats.total_it }}
            </div>
            <div style="text-align: center; margin-top: 0.5rem; opacity: 0.8;">
                Total IT Specialists
            </div>
        </div>
    </div>
    
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">Non-IT Writers</h3>
        </div>
        <div class="card-body">
            <div style="font-size: 2rem; font-weight: 700; color: #9C27B0; text-align: center;">
                {{ writer_stats.total_nonit }}
            </div>
            <div style="text-align: center; margin-top: 0.5rem; opacity: 0.8;">
                Total Non-IT Specialists
            </div>
        </div>
    </div>
    
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">Finance Writers</h3>
        </div>
        <div class="card-body">
            <div style="font-size: 2rem; font-weight: 700; color: #4CAF50; text-align: center;">
                {{ writer_stats.total_finance }}
            </div>
            <div style="text-align: center; margin-top: 0.5rem; opacity: 0.8;">
                Total Finance Specialists
            </div>
        </div>
    </div>
    
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">Available Writers</h3>
        </div>
        <div class="card-body">
            <div style="font-size: 2rem; font-weight: 700; color: #00BCD4; text-align: center;">
                {{ writer_stats.available }}
            </div>
            <div style="text-align: center; margin-top: 0.5rem; opacity: 0.8;">
                Currently Available
            </div>
        </div>
    </div>
    
    <div class="card">
        <div class="card-header">
            <h3 class="card-title">Engaged Writers</h3>
        </div>
        <div class="card-body">
            <div style="font-size: 2rem; font-weight: 700; color: #FF9800; text-align: center;">
                {{ writer_stats.engaged }}
            </div>
            <div style="text-align: center; margin-top: 0.5rem; opacity: 0.8;">
                Currently Working
            </div>
        </div>
    </div>
</div>

<style>
    .card {
        animation: fadeInUp 0.5s ease-out;
    }
    
    .data-table tbody tr:hover {
        background-color: var(--hover-bg);
        transform: scale(1.01);
    }
</style>
{% endblock %}
