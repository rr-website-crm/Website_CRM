<!-- process/templates/process/my_jobs.html -->
{% extends 'base.html' %}
{% load static %}

{% block title %}My Jobs - Process{% endblock %}

{% block content %}
<div class="dashboard-header">
    <div class="header-with-back">
        <div>
            <h1 class="dashboard-title">{{ page_title }}</h1>
            <p class="dashboard-subtitle">Active jobs assigned to you</p>
        </div>
        <a href="{% url 'process_dashboard' %}" class="btn-back-link">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M19 12H5M12 19l-7-7 7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            Back to Dashboard
        </a>
    </div>
</div>

<div class="table-container">
    <table class="data-table">
        <thead>
            <tr>
                <th>Job ID</th>
                <th>Topic</th>
                <th>Word Count</th>
                <th>Deadline</th>
                <th>Status</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            {% for job in jobs %}
            <tr>
                <td>
                    <span style="font-family: monospace; font-weight: 600; color: var(--primary);">
                        {{ job.get_masked_job_id }}
                    </span>
                </td>
                <td>{{ job.topic|truncatewords:8 }}</td>
                <td>{{ job.word_count }}</td>
                <td>{{ job.deadline|date:"d/m/Y H:i" }}</td>
                <td>
                    {% if job.status == 'allocated' %}
                    <span class="status-tag status-allocated">Allocated</span>
                    {% elif job.status == 'in_progress' %}
                    <span class="status-tag status-in-progress">In Progress</span>
                    {% endif %}
                </td>
                <td>
                    <a href="{% url 'view_job' job.job_id %}" class="btn btn-primary" style="padding: 8px 16px; font-size: 13px;">View</a>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="6" class="text-center" style="padding: 2rem;">No active jobs found.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- Pagination -->
{% if jobs.has_other_pages %}
<div style="display: flex; justify-content: center; gap: 1rem; margin-top: 2rem;">
    {% if jobs.has_previous %}
    <a href="?page={{ jobs.previous_page_number }}" class="btn btn-outline">Previous</a>
    {% endif %}
    <span style="color: var(--text-color);">Page {{ jobs.number }} of {{ jobs.paginator.num_pages }}</span>
    {% if jobs.has_next %}
    <a href="?page={{ jobs.next_page_number }}" class="btn btn-outline">Next</a>
    {% endif %}
</div>
{% endif %}

<style>
    .header-with-back {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 1.5rem;
        flex-wrap: wrap;
    }

</style>
{% endblock %}
